{
  "buildCommand": "npm run build && npm run build:api",
  "outputDirectory": "dist",
  "functions": {
    "api/**": {
      "excludeFiles": "{src,public,dist,docs,scripts,server/tests,**/*.test.js,**/*.spec.js,node_modules/sharp,node_modules/astro,node_modules/@astrojs,node_modules/vite,node_modules/react,node_modules/react-dom}/**"
    }
  },
  "rewrites": [
    { "source": "/api/(.*)", "destination": "/api/index" },
    { "source": "/health", "destination": "/api/index" },
    { "source": "/health/(.*)", "destination": "/api/index" },
    { "source": "/theme/(.*)", "destination": "/api/index" },
    { "source": "/r/(.*)", "destination": "/api/index" },
    { "source": "/robots.txt", "destination": "/api/index" },
    { "source": "/(.*)", "destination": "/api/index" }
  ]
}
